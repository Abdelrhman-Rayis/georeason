{% extends 'mundi_gis/base.html' %}

{% block title %}Upload Layer - {{ project.name }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">
                    <i class="fas fa-upload me-2"></i>Upload Layer to {{ project.name }}
                </h4>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data" novalidate>
                    {% csrf_token %}
                    
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                    
                    <div class="mb-3">
                        <label for="{{ form.name.id_for_label }}" class="form-label">
                            <i class="fas fa-tag me-1"></i>Layer Name *
                        </label>
                        {{ form.name }}
                        {% if form.name.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.name.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">Choose a descriptive name for this layer.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.layer_type.id_for_label }}" class="form-label">
                            <i class="fas fa-layer-group me-1"></i>Layer Type *
                        </label>
                        {{ form.layer_type }}
                        {% if form.layer_type.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.layer_type.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">Select the type of geographic data this layer contains.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.file_path.id_for_label }}" class="form-label">
                            <i class="fas fa-file-upload me-1"></i>GIS File *
                        </label>
                        {{ form.file_path }}
                        {% if form.file_path.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.file_path.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">
                            Upload your GIS file (GeoJSON, Shapefile, GeoTIFF, LAS/LAZ, CSV). Max size: 100MB.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.style_config.id_for_label }}" class="form-label">
                            <i class="fas fa-palette me-1"></i>Style Configuration (Optional)
                        </label>
                        {{ form.style_config }}
                        {% if form.style_config.errors %}
                            <div class="text-danger small mt-1">
                                {% for error in form.style_config.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">
                            Enter JSON configuration for styling this layer. Leave empty for default styling.
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{% url 'mundi_gis:project_detail' project.id %}" class="btn btn-secondary me-md-2">
                            <i class="fas fa-times me-1"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-upload me-1"></i>Upload Layer
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- File Format Help -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Supported File Formats
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-vector-square text-primary me-2"></i>Vector Data</h6>
                        <ul class="small">
                            <li><strong>GeoJSON (.geojson)</strong> - Points, lines, polygons</li>
                            <li><strong>Shapefile (.shp)</strong> - ESRI shapefile format</li>
                            <li><strong>CSV (.csv)</strong> - Point data with coordinates</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-image text-success me-2"></i>Raster & Point Cloud</h6>
                        <ul class="small">
                            <li><strong>GeoTIFF (.tif)</strong> - Satellite imagery, elevation data</li>
                            <li><strong>LAS/LAZ (.las/.laz)</strong> - LiDAR point cloud data</li>
                        </ul>
                    </div>
                </div>
                
                <hr>
                
                <h6><i class="fas fa-lightbulb text-warning me-2"></i>Upload Tips:</h6>
                <ul class="small">
                    <li>Ensure your file has proper coordinate reference system (CRS)</li>
                    <li>For CSV files, include latitude and longitude columns</li>
                    <li>Shapefiles should include all related files (.shp, .shx, .dbf, etc.)</li>
                    <li>Large files may take longer to process</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %} 